<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>OMP 思 志 </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no,minimal-ui" />
    <link href="css/reset.css" rel="stylesheet" />
    <script src="http://libs.useso.com/js/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://code.createjs.com/easeljs-0.8.1.min.js"></script>
    <script src="http://code.createjs.com/tweenjs-0.6.1.min.js"></script>
    <script src="http://code.createjs.com/movieclip-0.8.1.min.js"></script>
    <script src="http://code.createjs.com/preloadjs-0.6.1.min.js"></script>
    <script src="jquery.transit.js"></script>
    <script src="index.js"></script>
    <script>
    var canvas, stage, exportRoot;

    function init() {
        canvas = document.getElementById("canvas");
        images = images || {};
        ss = ss || {};

        var loader = new createjs.LoadQueue(false);
        loader.addEventListener("fileload", handleFileLoad);
        loader.addEventListener("complete", handleComplete);
        loader.addEventListener("progress", handleProgress);
        loader.loadFile({
            src: "images/index_atlas_.json",
            type: "spritesheet",
            id: "index_atlas_"
        }, true);
        loader.loadManifest(lib.properties.manifest);
    }

    function handleFileLoad(evt) {
        if (evt.item.type == "image") {
            images[evt.item.id] = evt.result;
        }
    }

    function handleComplete(evt) {
        var queue = evt.target;
        ss["index_atlas_"] = queue.getResult("index_atlas_");
        exportRoot = new lib.index();

        stage = new createjs.Stage(canvas);
        stage.addChild(exportRoot);
        stage.update();

        createjs.Ticker.setFPS(lib.properties.fps);
        createjs.Ticker.addEventListener("tick", stage);
    }

    function handleProgress(evt) {
        var loaded = Math.floor(evt.loaded * 100);
        $(".progress").text(loaded + "%");

    }
    </script>
</head>

<body onload="init();" style="background-color:#D4D4D4">
    <div class="site-body">
        <div id="minisite">
            <!-- bigBgBody start -->
            <div id="bigBgBody" class="big-bg-body">
                <canvas id="canvas" width="640" height="1039"></canvas>
            </div>
            <!-- bigBgBody end -->
            <!-- loadBody start -->
            <div id="loadBody" class="load-body">
                <div class="load-watch-main">
                    <div class="progress">0%</div>
                </div>
            </div>
            <!-- loadBody end -->
        </div>
    </div>
    <script type="text/javascript">
    function onResize() {
        var domwidth = document.documentElement.clientWidth;
        var domheight = document.documentElement.clientHeight;

        var scale = Math.max(domwidth / 320, domheight / 504);
        var width = 320 * scale;
        var height = 504 * scale;
        $minisite.css({
            scale: [scale, scale],
            left: -(width - domwidth) / 2,
            top: -(height - domheight) / 2
        });

    }

    $minisite = $('#minisite');
    $(window).resize(onResize);
    onResize();
    </script>
</body>

</html>
